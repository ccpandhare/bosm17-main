<!DOCTYPE html>
<html>
  <head>

    <!-- Meta Tags -->
    <meta charset="utf-8">

    <title>BOSM 2017 | BITS Pilani</title>

    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/main.css">

    <!-- jQuery -->
    <script src="js/jquery.js" charset="utf-8"></script>

    <!-- GSAP TweenMax - Reduce to TimelineLite if possible -->
    <script src="js/TweenMax.min.js"></script>

    <!-- ScrollMagic JS Files -->
    <script src="js/ScrollMagic.min.js"></script>
    <script src="js/debug.addIndicators.min.js"></script>
    <script src="js/animation.gsap.js"></script>

  </head>
  <body>

    <!-- Begin Scenes -->

    <div class="scene" id="sceneOut">
      include "svg/out.svg"
    </div>

    <div class="scene" id="sceneIn">
      include "svg/in.svg"
    </div>

    <div class="scene" id="sceneTorch">
      include "svg/torch.svg"
    </div>

    <div class="scene" id="sceneFinal">
      include "svg/final.svg"
    </div>

    <!-- Main Script -->
    <script type="text/javascript">
      $(function(){

        // Make SVGs span entire div and a greedy bugfix
        $('svg').each(function(){
          this.setAttribute('preserveAspectRatio','xMidYMid slice');
          $(this).parent().css('margin-bottom','-10px');
        });

        // Start a ScrollMagic controller
        var controller = new ScrollMagic.Controller();

        // Initiate ScrollMagic sceneOut and add to controller
        var sceneOut = new ScrollMagic.Scene({
          triggerElement: "#sceneOut",
          triggerHook: 0,
          duration: 2000,
          reverse: true,
          pushFollowers: false
        }).setPin("#sceneOut").addTo(controller);

        // timeline for sceneOut

       var sceneOutTimeline = new TimelineLite();
       var torch = $('#sceneOut g[data-name=Torch]');
       var buildings = $('#sceneOut .building');
       var bushTree = $('#sceneOut g[data-name=Bushes_Trees]');
       var fire = $('#sceneOut g[data-name=Fire]');
       var lights = $('#sceneOut g[data-name=Shine]');
       var stadium = $('#sceneOut g[data-name=Stadium]');
       var skyEle = $('#sceneOut g[data-name=Sky_Elements]');
       var grass = $('#sceneOut .grass');
       var background = $('#sceneOut .background');
       var origin_stadium = stadium.width() - $(window).width()/2;

       var fadeIn = {autoAlpha:1, ease:Power4.easeOut, yPercent: 0};
       stadium.css('position', 'relative');


       sceneOutTimeline.set([skyEle, bushTree, torch, fire, lights, buildings],{autoAlpha:0, yPercent: 10, transformOrigin: '50% 50%'})
       // .to([grass,background], .01, fadeIn)
       .to(lights, .01, fadeIn)
       .to(buildings, .08, fadeIn)
       .to([skyEle,bushTree], .1, fadeIn)
       .to(torch, 0.03, fadeIn)
       .to(fire, 0.01, fadeIn)
       .to([stadium, bushTree], 0.03, {scale: 2, ease: Power4.easeOut});
       console.log(lights)

       sceneOut.setTween(sceneOutTimeline)

        // Initiate ScrollMagic sceneIn and add to controller
        var sceneIn = new ScrollMagic.Scene({
          triggerElement: "#sceneIn",
          triggerHook: 0,
          duration: $("#sceneIn").height(),
          reverse: true,
          pushFollowers: false
        }).setPin("#sceneIn").addTo(controller);

        // Initiate ScrollMagic sceneTorch and add to controller
        var sceneTorch = new ScrollMagic.Scene({
          triggerElement: "#sceneTorch",
          triggerHook: 0,
          duration:  $("#sceneTorch").height(),
          reverse: true,
          pushFollowers: false
        }).setPin("#sceneTorch").addTo(controller);

        // Initiate ScrollMagic sceneFinal and add to controller
        var sceneFinal = new ScrollMagic.Scene({
          triggerElement: "#sceneFinal",
          triggerHook: 0,
          duration:  $("#sceneFinal").height(),
          reverse: true,
          pushFollowers: false
        }).setPin("#sceneFinal").addTo(controller);

      });
    </script>
  </body>
</html>
